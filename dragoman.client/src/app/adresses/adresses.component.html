<!-- Onglets globaux -->
<app-navbarinter></app-navbarinter>
<section class="card">
  <header class="card-header">
    <h2>Adresses â€” InterprÃ¨te #{{ tolkcode }}</h2>
    <div class="card-actions">
      <label class="chk">
        <input type="checkbox" [checked]="onlyActive" (change)="toggleActive()"> Uniquement actives
      </label>
      <button type="button" (click)="create()">â• Nouvelle</button>
    </div>
  </header>

  <div *ngIf="loading" class="info">Chargementâ€¦</div>
  <div *ngIf="error" class="error">{{ error }}</div>

  <!-- Liste -->
  <div class="table-wrap" *ngIf="!loading">
    <table class="tbl">
      <thead>
        <tr>
          <th>Pays</th>
          <th>CP</th>
          <th>Commune</th>
          <th>Rue</th>
          <th>NÂ°</th>
          <th>BoÃ®te</th>
          <th>DÃ©but</th>
          <th>Fin</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let r of rows">
          <td>{{ r.land }}</td>
          <td>{{ r.cp }}</td>
          <td>{{ r.commune }}</td>
          <td>{{ r.rue }}</td>
          <td>{{ r.numero }}</td>
          <td>{{ r.boite }}</td>
          <td>{{ r.startdate | date:'yyyy-MM-dd' }}</td>
          <td>{{ r.enddate   | date:'yyyy-MM-dd' }}</td>
          <td class="actions">
            <button type="button" (click)="edit(r)" title="Modifier">âœï¸</button>
            <button type="button" class="danger" (click)="remove(r)" title="Supprimer">ğŸ—‘ï¸</button>
          </td>
        </tr>
        <tr *ngIf="rows.length === 0">
          <td colspan="9" class="muted">Aucune adresse</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Formulaire upsert (mÃªme entitÃ© que l'API) -->
  <form [formGroup]="f" (ngSubmit)="submit()" class="form-card" *ngIf="formVisible">
    <h3 *ngIf="editingId; else addTpl">Modifier lâ€™adresse #{{ editingId }}</h3>
    <ng-template #addTpl><h3>Nouvelle adresse</h3></ng-template>

    <div class="grid-2">
      <label>Pays *<input formControlName="land" required></label>
      <label>CP *<input formControlName="cp" required></label>
      <label>Commune *<input formControlName="commune" required></label>
      <label>Rue<input formControlName="rue"></label>
      <label>NumÃ©ro<input formControlName="numero"></label>
      <label>BoÃ®te<input formControlName="boite"></label>
      <label>Km<input type="number" formControlName="km"></label>
      <label>DÃ©but *<input type="date" formControlName="startdate" required></label>
      <label>Fin<input type="date" formControlName="enddate"></label>
    </div>

    <div class="form-actions">
      <button type="submit" [disabled]="saving || f.invalid">ğŸ’¾ Enregistrer</button>
      <button type="button" class="ghost" (click)="cancel()">Annuler</button>
    </div>
  </form>
</section>
